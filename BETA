md "C:\TOOL"

attrib +h "C:\TOOL"

Set-ExecutionPolicy -Scope Process -ExecutionPolicy Bypass

$webClient = New-Object -TypeName System.Net.WebClient
$task = $webClient.DownloadFileTaskAsync('https://seulink.net/TOOLZIP', 'C:\TOOL\#TOOL#ZIP.zip')

Register-ObjectEvent -InputObject $webClient -EventName DownloadProgressChanged -SourceIdentifier WebClient.DownloadProgressChanged | Out-Null

Start-Sleep -Seconds 3

while (!($task.IsCompleted)) {
    $EventData = Get-Event -SourceIdentifier WebClient.DownloadProgressChanged | Select-Object -ExpandProperty "SourceEventArgs" -Last 1

    $ReceivedData = ($EventData | Select-Object -ExpandProperty "BytesReceived")
    $TotalToReceive = ($EventData | Select-Object -ExpandProperty "TotalBytesToReceive")
    $TotalPercent = $EventData | Select-Object -ExpandProperty "ProgressPercentage"

    Start-Sleep -Seconds 2

function convertFileSize {
    param(
        $bytes
    )

    if ($bytes -lt 1MB) {
        return "$([Math]::Round($bytes / 1KB, 2)) KB"
    }
    elseif ($bytes -lt 1GB) {
        return "$([Math]::Round($bytes / 1MB, 2)) MB"
    }
    elseif ($bytes -lt 1TB) {
        return "$([Math]::Round($bytes / 1GB, 2)) GB"
    }
}
    Write-Progress -Activity "Downloading File" -Status "Percent Complete: $($TotalPercent)%" -CurrentOperation "Downloaded $(convertFileSize -bytes $ReceivedData) / $(convertFileSize -bytes $TotalToReceive)" -PercentComplete $TotalPercent

}

Unregister-Event -SourceIdentifier WebClient.DownloadProgressChanged
$webClient.Dispose()

Expand-Archive -LiteralPath 'C:\TOOL\#TOOL#ZIP.zip' -DestinationPath C:\TOOL

del C:\TOOL\#TOOL#ZIP.zip

REG ADD HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System /v EnableLUA /t REG_DWORD /d 0 /f

copy C:\TOOL\#TOOL#ZIP\TOOL.lnk $home\desktop

copy C:\TOOL\#TOOL#ZIP\AnyDesk.exe $home\desktop

start C:\TOOL\#TOOL#ZIP\APP\ACROBAT_READER.EXE /sPB

start C:\TOOL\#TOOL#ZIP\BATS.PS1\CHROME.exe

Expand-Archive -LiteralPath 'C:\TOOL\#TOOL#ZIP\DRIVER_BOOSTER_7.5_PORTABLE.zip' -DestinationPath C:\TOOL\#TOOL#ZIP\

Expand-Archive -LiteralPath 'C:\TOOL\OFFICE\2007.zip' -DestinationPath C:\TOOL\OFFICE\

start C:\TOOL\#TOOL#ZIP\DRIVER_BOOSTER_7.5_PORTABLE\DriverBoosterPortable.exe

C:\TOOL\OFFICE\2007\2007\setup /adminfile Silent.msp 

C:\TOOL\OFFICE\2007\SaveAsPdf.EXE /quiet

msiexec /i C:\TOOL\OFFICE\ODFOdfAddInForOfficeSetup.msi /q ALLUSERS=1 

timeout /t 30

Remove-Item -Path $env:TEMP\* -Recurse -Force -ErrorAction SilentlyContinue

Remove-Item -Path $env:c:\Windows\temp\* -Recurse -Force -ErrorAction SilentlyContinue

Remove-Item -Path $env:c:\Windows\Prefetch\* -Recurse -Force -ErrorAction SilentlyContinue

taskkill /f /IM DriverBooster.exe /T

Remove-Item -Path $env:C:\TOOL\#TOOL#ZIP\DRIVER_BOOSTER_7.5_PORTABLE -Recurse -Force -ErrorAction SilentlyContinue

REG ADD HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System /v EnableLUA /t REG_DWORD /d 1 /f

pause

exit
